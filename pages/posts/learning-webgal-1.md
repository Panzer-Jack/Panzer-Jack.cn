---
title: å¦‚ä½•ç”¨ WebGL å»å®ç°ä¸€ä¸ªå›¾ç‰‡èƒŒæ™¯é€æ˜åŒ–å°å·¥å…·
date: "2026-02-25 21:13:14"
tags:
    - å‰ç«¯å­¦ä¹ 
    - webgl
cover: https://pic.imgdb.cn/item/63770c5416f2c2beb107d59f.png
---

## å…ˆç®€è¦ä»‹ç»ä¸€ä¸‹ WebGL

å½“ä»Šå¤§å¤šæ•°ä¸»æµæµè§ˆå™¨å­˜åœ¨2ä¸ª WebGL ç‰ˆæœ¬: `WebGL 1.0`ï¼ˆåŸºäº OpenGL ES2.0ï¼‰ã€`WebGL 2.0`ï¼ˆåŸºäº OpenGL ES3.0ï¼‰

```ts
const canvas = document.createElement('canvas');
const gl = canvas.getContext('webgl')
const gl2 = canvas.getContext('webgl2')
```

åœ¨ WebGL ä¸­ï¼Œæ‰€æœ‰çš„ç»˜åˆ¶æ“ä½œéƒ½æ˜¯é€šè¿‡ç€è‰²å™¨ï¼ˆShaderï¼‰æ¥å®Œæˆçš„ã€‚ç€è‰²å™¨æ˜¯ä¸€æ®µè¿è¡Œåœ¨ GPU ä¸Šçš„å°ç¨‹åºï¼Œå¹¶ä¸”ä¸ºä¸€å¯¹å‡½æ•°çš„å½¢å¼ç»„æˆï¼š

- `é¡¶ç‚¹ç€è‰²å™¨ï¼ˆVertex Shaderï¼‰`ï¼šè´Ÿè´£å¤„ç†æ¯ä¸ªé¡¶ç‚¹çš„æ•°æ®ï¼Œè¿›è¡Œå˜æ¢å’ŒæŠ•å½±ç­‰æ“ä½œã€‚

- `ç‰‡æ®µç€è‰²å™¨ï¼ˆFragment Shaderï¼‰`ï¼šè´Ÿè´£å¤„ç†æ¯ä¸ªç‰‡æ®µï¼ˆåƒç´ ï¼‰çš„æ•°æ®ï¼Œè¿›è¡Œé¢œè‰²è®¡ç®—å’Œçº¹ç†é‡‡æ ·ç­‰æ“ä½œã€‚

å…¶ç»„åˆåˆç§°ä¸º`ç¨‹åºï¼ˆProgramï¼‰`ï¼Œè€Œç¨‹åºä¸­çš„ç€è‰²å™¨ä¼šåœ¨ GPU ä¸Šå¯¹æ¯ä¸ªé¡¶ç‚¹/ç‰‡å…ƒå¹¶è¡Œæ‰§è¡Œï¼Œè¿™ä¹Ÿæ˜¯ WebGL èƒ½å¤Ÿå®ç°é«˜æ€§èƒ½å›¾å½¢æ¸²æŸ“çš„åŸå› ä¹‹ä¸€ã€‚ä½ å¯ä»¥æƒ³è±¡å¦‚æœæ˜¯ CPU å¤„ç†ï¼Œå®ƒåªæœ‰å°‘é‡æ ¸å¿ƒï¼Œå¹¶ä¸”åœ¨Webåœºæ™¯ä¸Šä»¥å•æ ¸å¿ƒé¢å¯¹æ•°ç™¾ä¸‡ä¸ªåƒç´ é€ä¸ªè®¡ç®—ï¼Œè€Œ GPU æ‹¥æœ‰æˆç™¾ä¸Šåƒä¸ªæ ¸å¿ƒï¼Œå¯ä»¥åŒæ—¶å¤„ç†å¤§é‡åƒç´ ï¼Œæ•ˆç‡è‡ªç„¶å¤©å·®åœ°åˆ«ã€‚

åœ¨ WebGL ä¸­ï¼Œé¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨éƒ½æ˜¯ç”¨ GLSLï¼ˆOpenGL Shading Languageï¼‰ç¼–å†™çš„ã€‚GLSL æ˜¯ä¸€ç§ä¸“é—¨ä¸ºå›¾å½¢ç¼–ç¨‹è®¾è®¡çš„è¯­è¨€ï¼Œå…·æœ‰ç±»ä¼¼äº C è¯­è¨€çš„è¯­æ³•ç»“æ„ã€‚æˆ‘è¿™è¾¹ä»¥WebGL 2.0ä¸ºä¾‹ï¼Œæ¥å±•ç¤ºä¸€ä¸‹æœ€åŸºæœ¬çš„ç€è‰²å™¨ä»£ç ç¤ºä¾‹ï¼š

é¡¶ç‚¹ç€è‰²å™¨ï¼ˆVertex Shaderï¼‰ç¤ºä¾‹ï¼š

```glsl
#version 300 es
// ğŸ‘†è¿™é‡Œçš„ #version 300 es æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ WebGL 2.0 çš„ GLSL ç‰ˆæœ¬
// å¹¶ä¸”å¿…é¡»æ”¾åœ¨ç€è‰²å™¨ä»£ç çš„ç¬¬ä¸€è¡Œï¼Œå¦åˆ™å°†é»˜è®¤è®¾ç½®ä¸º GLSL ES 1.00ï¼ˆå³ WebGL 1.0 çš„è¯­æ³•ï¼‰

// å£°æ˜è¾“å…¥å˜é‡ a_positionï¼Œç±»å‹ä¸º vec4ï¼ˆ4ç»´å‘é‡ï¼‰ï¼Œè¡¨ç¤ºé¡¶ç‚¹çš„ä½ç½®
in vec4 a_position;

void main() {
  // å°†è¾“å…¥çš„é¡¶ç‚¹ä½ç½®ç›´æ¥èµ‹å€¼ç»™å†…ç½®å˜é‡ gl_Positionï¼Œè¡¨ç¤ºæœ€ç»ˆçš„é¡¶ç‚¹ä½ç½®
  gl_Position = a_position;
}
```

ç‰‡æ®µç€è‰²å™¨ï¼ˆFragment Shaderï¼‰ç¤ºä¾‹ï¼š

```glsl
#version 300 es

// å£°æ˜æµ®ç‚¹æ•°çš„ç²¾åº¦ä¸º highpï¼ˆé«˜ç²¾åº¦ï¼‰ï¼Œè¿™æ˜¯ WebGL 2.0 ä¸­çš„ä¸€ä¸ªè¦æ±‚ï¼Œç¡®ä¿åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­ä½¿ç”¨é«˜ç²¾åº¦çš„æµ®ç‚¹æ•°
precision highp float;

// å£°æ˜è¾“å‡ºå˜é‡ outColorï¼Œç±»å‹ä¸º vec4ï¼ˆ4ç»´å‘é‡ï¼‰ï¼Œè¡¨ç¤ºç‰‡æ®µçš„é¢œè‰²
// å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ WebGL 1.0ï¼Œé‚£ä¹ˆç‰‡æ®µç€è‰²å™¨ä¸­åº”è¯¥ä½¿ç”¨å†…ç½®å˜é‡ gl_FragColor æ¥è¾“å‡ºé¢œè‰²ï¼Œè€Œä¸æ˜¯è‡ªå®šä¹‰çš„è¾“å‡ºå˜é‡
// åœ¨ WebGL 2.0 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ out å…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªè¾“å‡ºå˜é‡ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä½¿ç”¨ gl_FragColor äº†
// å¹¶ä¸”åœ¨ WebGL 2.0 ä¸­ï¼Œç¬¬ä¸€ä¸ªå£°æ˜çš„è¾“å‡ºå˜é‡é»˜è®¤ç»‘å®šåˆ°é¢œè‰²ç¼“å†²åŒº 0ï¼ˆå³ gl_FragColorï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ outColor æ¥è¾“å‡ºé¢œè‰²
out vec4 outColor;

// å¦‚æœæœ‰å¤šä¸ªè¾“å‡ºå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ layout(location = X) æ¥æŒ‡å®šå®ƒä»¬åœ¨é¢œè‰²ç¼“å†²åŒºä¸­çš„ä½ç½®ï¼Œè¿™æ ·å°±å¯ä»¥åŒæ—¶è¾“å‡ºåˆ°å¤šä¸ªç¼“å†²åŒºäº†
// åœ¨ GLSL ä¸­æ‰‹åŠ¨æŒ‡å®šä½ç½®
// layout(location = 0) out vec4 outColor;     è¾“å‡ºåˆ°é¢œè‰²ç¼“å†²
// layout(location = 1) out vec4 outNormal;    è¾“å‡ºåˆ°å¦ä¸€ä¸ªç¼“å†²

void main() {
  // å°†è¾“å‡ºé¢œè‰²è®¾ç½®ä¸ºçº¢è‰²ï¼ˆRGBA: 1.0, 0.0, 0.0, 1.0ï¼‰
  outColor = vec4(1.0, 0.0, 0.0, 1.0);
}
```

#### ç®€è¦ä»‹ç»ä¸€ä¸‹æ ¸å¿ƒæ¦‚å¿µï¼š

1. `å±æ€§ï¼ˆAttributeï¼‰`ã€`ç¼“å†²åŒºï¼ˆBufferï¼‰`ã€`é¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼ˆVertex Array Objectï¼ŒVAOï¼‰`ï¼š

`å±æ€§ï¼ˆAttributeï¼‰`ï¼šè¿™æ˜¯é¡¶ç‚¹ç€è‰²å™¨ä¸­çš„è¾“å…¥å˜é‡ï¼Œç”¨äºæ¥æ”¶æ¯ä¸ªé¡¶ç‚¹çš„æ•°æ®ï¼Œä¾‹å¦‚ä½ç½®ã€é¢œè‰²ã€çº¹ç†åæ ‡ç­‰ã€‚å±æ€§å˜é‡åœ¨ JavaScript ä¸­é€šè¿‡ç¼“å†²åŒºå¯¹è±¡ï¼ˆBuffer Objectï¼‰ä¼ é€’ç»™ GPUã€‚

```glsl
// è¿™æ˜¯ä¸€ä¸ªå±æ€§å˜é‡ï¼Œè¡¨ç¤ºé¡¶ç‚¹çš„ä½ç½®
// å‘½åä»¥ a_ å¼€å¤´æ˜¯ä¸€ä¸ªå¸¸è§çš„çº¦å®šï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå±æ€§å˜é‡
in vec4 a_position;
```

`ç¼“å†²åŒºï¼ˆBufferï¼‰`ï¼šè¿™æ˜¯ WebGL ä¸­ç”¨äºå­˜å‚¨æ•°æ®çš„å¯¹è±¡ï¼Œå¯ä»¥å­˜å‚¨é¡¶ç‚¹æ•°æ®ã€ç´¢å¼•æ•°æ®ç­‰ã€‚ç¼“å†²åŒºåœ¨ JavaScript ä¸­é€šè¿‡ WebGL API åˆ›å»ºå’Œä½¿ç”¨ã€‚

`é¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼ˆVertex Array Objectï¼ŒVAOï¼‰`ï¼šè¿™æ˜¯ WebGL 2.0 ä¸­å¼•å…¥çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨äºç®¡ç†å±æ€§å˜é‡å’Œç¼“å†²åŒºä¹‹é—´çš„å…³ç³»ã€‚ç®€å•æ¥è¯´ï¼Œé¡¶ç‚¹æ•°ç»„å¯¹è±¡ç›¸å½“äºæ˜¯ä¸€ä¸ªçŠ¶æ€å¿«ç…§ï¼Œå°†å±æ€§å˜é‡çš„é…ç½®å’Œç»‘å®šä¿¡æ¯ä¿å­˜èµ·æ¥ï¼Œè¿™æ ·åœ¨ç»˜åˆ¶æ—¶åªéœ€è¦ç»‘å®šé¡¶ç‚¹æ•°ç»„å¯¹è±¡å³å¯æ¢å¤ä¹‹å‰çš„é…ç½®ï¼Œé¿å…äº†é‡å¤è®¾ç½®å±æ€§å˜é‡å’Œç¼“å†²åŒºçš„éº»çƒ¦ã€‚

2. `ç»Ÿä¸€å˜é‡ï¼ˆUniformï¼‰`ï¼šè¿™æ˜¯é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨ä¸­çš„è¾“å…¥å˜é‡ï¼Œç”¨äºæ¥æ”¶å…¨å±€æ•°æ®ï¼Œä¾‹å¦‚å˜æ¢çŸ©é˜µã€å…‰ç…§å‚æ•°ç­‰ã€‚ç»Ÿä¸€å˜é‡åœ¨ JavaScript ä¸­é€šè¿‡ç¨‹åºå¯¹è±¡ï¼ˆProgram Objectï¼‰ä¼ é€’ç»™ GPUã€‚

```glsl
// è¿™æ˜¯ä¸€ä¸ªç»Ÿä¸€å˜é‡ï¼Œè¡¨ç¤ºçº¹ç†é‡‡æ ·å™¨ï¼Œç”¨äºåœ¨ç‰‡æ®µç€è‰²å™¨ä¸­è®¿é—®çº¹ç†æ•°æ®
// å‘½åä»¥ u_ å¼€å¤´æ˜¯ä¸€ä¸ªå¸¸è§çš„çº¦å®šï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªç»Ÿä¸€å˜é‡
uniform sampler2D u_texture;
```

3. `çº¹ç†ï¼ˆTextureï¼‰`ï¼šè¿™æ˜¯ç‰‡æ®µç€è‰²å™¨ä¸­çš„è¾“å…¥å˜é‡ï¼Œç”¨äºæ¥æ”¶çº¹ç†æ•°æ®ï¼Œä¾‹å¦‚å›¾ç‰‡ã€è§†é¢‘ç­‰ã€‚çº¹ç†åœ¨ JavaScript ä¸­é€šè¿‡çº¹ç†å¯¹è±¡ï¼ˆTexture Objectï¼‰ä¼ é€’ç»™ GPUã€‚ï¼ˆæ¯”å¦‚å›¾ç‰‡å°±æ˜¯ä¸€ç§çº¹ç†ï¼‰

```glsl
// é€šå¸¸ çº¹ç†çš„é‡‡æ ·å™¨ä¼šè¢«å£°æ˜ä¸ºä¸€ä¸ªç»Ÿä¸€å˜é‡ï¼Œç±»å‹ä¸º sampler2Dï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªäºŒç»´çº¹ç†
uniform sampler2D u_texture;
```

4. `å†…ç½®å˜é‡ï¼ˆBuilt-in Variableï¼‰`ï¼šè¿™æ˜¯ GLSL ä¸­é¢„å®šä¹‰çš„å˜é‡ï¼Œç”¨äºè¡¨ç¤ºä¸€äº›ç‰¹æ®Šçš„æ•°æ®ï¼Œä¾‹å¦‚ gl_Positionï¼ˆé¡¶ç‚¹ä½ç½®ï¼‰ã€gl_FragColorï¼ˆç‰‡æ®µé¢œè‰²ï¼‰ç­‰ã€‚è¿™äº›å˜é‡åœ¨ç€è‰²å™¨ä¸­å…·æœ‰ç‰¹æ®Šçš„æ„ä¹‰å’Œç”¨é€”ã€‚

```glsl
// è¿™æ˜¯ä¸€ä¸ªå†…ç½®å˜é‡ï¼Œè¡¨ç¤ºæœ€ç»ˆçš„é¡¶ç‚¹ä½ç½®ï¼Œå¿…é¡»åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­èµ‹å€¼
gl_Position = a_position;
```

5. `ç¨‹åºå¯¹è±¡ï¼ˆProgram Objectï¼‰`ï¼šè¿™æ˜¯ WebGL ä¸­ç”¨äºç®¡ç†ç€è‰²å™¨ç¨‹åºçš„å¯¹è±¡ï¼ŒåŒ…å«äº†é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨çš„ç»„åˆã€‚ç¨‹åºå¯¹è±¡åœ¨ JavaScript ä¸­é€šè¿‡ WebGL API åˆ›å»ºå’Œä½¿ç”¨ã€‚

6. `æ’å€¼å˜é‡ï¼ˆVaryingï¼‰`ï¼šè¿™æ˜¯é¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡æ®µç€è‰²å™¨ä¹‹é—´çš„å˜é‡ï¼Œç”¨äºåœ¨ä¸¤è€…ä¹‹é—´ä¼ é€’æ•°æ®ï¼Œä¾‹å¦‚é¢œè‰²ã€çº¹ç†åæ ‡ç­‰ã€‚æ’å€¼å˜é‡åœ¨ JavaScript ä¸­é€šè¿‡ç¨‹åºå¯¹è±¡ä¼ é€’ç»™ GPUã€‚(æ¯”å¦‚å¸¸è§çš„æ¸å˜è‰²å°±æ˜¯é€šè¿‡æ’å€¼å˜é‡æ¥å®ç°çš„)

> æ³¨æ„ï¼šåœ¨ WebGL 2.0 ä¸­ï¼Œæ’å€¼å˜é‡çš„æ˜¾ç¤ºå£°æ˜å·²ç»è¢«åºŸå¼ƒï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä½¿ç”¨ out å…³é”®å­—åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­å£°æ˜è¾“å‡ºå˜é‡ï¼Œå¹¶åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­ä½¿ç”¨ in å…³é”®å­—å£°æ˜è¾“å…¥å˜é‡æ¥æ¥æ”¶è¿™äº›æ•°æ®ã€‚

## å®ç°ä¸€ä¸ªå›¾ç‰‡èƒŒæ™¯é€æ˜åŒ–å°å·¥å…·

#### å®é™…æ•ˆæœ

<PickAlpha />

## å‚è€ƒé“¾æ¥

1. https://webgl2fundamentals.org/webgl/lessons/zh_cn/webgl-fundamentals.html

2. https://messiahhh.github.io/blog/docs/canvas/webgl
